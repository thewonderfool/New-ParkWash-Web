"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5173],{989:function(t,e,n){n.r(e),n.d(e,{default:function(){return O}});var i=n(3038),o=n.n(i),a=n(8926),r=n.n(a),s=n(4575),p=n.n(s),c=n(3913),l=n.n(c),u=n(9713),d=n.n(u),h=n(7757),f=n.n(h),m=n(7041),v=n(1548);function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){d()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O=function(){function t(e){var n=e.el,i=e.mapOptionOverrides,o=void 0===i?{}:i,a=e.pointButtonSelector,r=void 0===a?"[data-imap-point]":a,s=e.mapElSelector,c=void 0===s?"[data-imap-map]":s;p()(this,t),d()(this,"el",void 0),d()(this,"mapEl",void 0),d()(this,"mapOptionOverrides",void 0),d()(this,"mapOptions",void 0),d()(this,"pointButtonSelector",void 0),d()(this,"openInfoWindow",void 0),d()(this,"isLoadingClass","is-loading"),d()(this,"modal",void 0),d()(this,"basicMapInstance",void 0),d()(this,"listenerBoss",void 0),this.el=n,this.mapOptionOverrides=o,this.pointButtonSelector=r,this.mapEl=this.el.querySelector(c),this.mapEl?(this.listenerBoss=new m.Z,this.modal=new v.Z({el:this.el,name:"imap"}),this.setUpPointButtons()):console.error("the map el could not be found",c)}var e,i,a;return l()(t,[{key:"setUpPointButtons",value:function(){var t=this;this.listenerBoss.register(document,"click",(function(e){e.target.matches(t.pointButtonSelector)&&t.openFromClick(e.target)}))}},{key:"openFromClick",value:(a=r()(f().mark((function t(e){var i,o,a,r,s,p,c,l,u,d;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.getAttribute("data-marker-lat")||"",o=e.getAttribute("data-marker-lng")||"",a=e.getAttribute("data-marker-title")||"",r=e.getAttribute("data-imap-point")||"",s=document.querySelector('[data-map-info="'.concat(r,'"]')),p=s?s.innerHTML:"",t.next=8,n.e(8705).then(n.bind(n,1106));case 8:c=t.sent,l=c.mapMarkerBaseSettingsAlt,i&&o?(u=g(g({},l),{},{fillColor:this.el.getAttribute("data-color")}),(d={lat:i,lng:o,title:a,icon:u}).uniqueId=r,d.infoWindowContent=p||a,this.openMap([d])):console.warn("missing lat or lng for marker",e);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"setUpMap",value:(i=r()(f().mark((function t(e){var i,a,r,s,p,c,l=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.basicMapInstance){t.next=2;break}return t.abrupt("return");case 2:return i=this.el.getAttribute("data-map-theme")||"standard",t.next=5,Promise.all([n.e(2671).then(n.bind(n,4808)),n.e(8705).then(n.bind(n,1106))]);case 5:return a=t.sent,r=o()(a,2),s=r[0].default,p=r[1].getDefaultMapOptions,t.next=11,p(i);case 11:c=t.sent,this.mapOptions=g(g({},c),this.mapOptionOverrides),this.basicMapInstance=new s({outerEl:this.el,mapOptions:this.mapOptions,points:e,mapElSelector:"[data-imap-map]",onMapReady:function(t,e){l.handleMapReady(t,e)}});case 14:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"openMap",value:(e=r()(f().mark((function t(e){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.basicMapInstance){t.next=5;break}return t.next=3,this.setUpMap(e);case 3:t.next=6;break;case 5:this.basicMapInstance.changePoints(e);case 6:this.modal.open();case 7:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"handleMapReady",value:function(t,e){var n=this;if(e.length&&e.forEach((function(e){var i=new google.maps.InfoWindow({maxWidth:320,content:e.point.infoWindowContent});e.addListener("click",(function(){n.openInfoWindow?(n.openInfoWindow.close(),n.openInfoWindow===i?n.openInfoWindow=null:(i.open(t,e),n.openInfoWindow=i)):(i.open(t,e),n.openInfoWindow=i),console.log(n.openInfoWindow)}))})),1===e.length){var i=e[0];google.maps.event.trigger(i,"click"),t.panTo(i.getPosition()),t.setZoom(this.mapOptions.zoom)}}}]),t}()}}]);